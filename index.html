<script>
  function buscarEEnviarParaAPIs() {
    var billId = document.getElementById('billId').value;
    buscarAPI(billId);
  }

  function buscarAPI(billId) {
    var urlSienge = 'https://api.sienge.com.br/ebm/public/api/v1/bills/' + billId;

    fetch(urlSienge)
      .then(response => {
        if (!response.ok) {
          throw new Error('Erro na chamada da API Sienge: ' + response.status);
        }
        return response.text();
      })
      .then(data => {
        try {
          // Tenta converter a resposta para JSON
          var jsonData = JSON.parse(data);
          exibirResultado(jsonData);
          enviarParaMilvus(jsonData);
        } catch (error) {
          // Se houver um erro ao converter para JSON, assume que a resposta é um texto simples
          exibirResultado(data);
          enviarParaMilvus({ chamado_descricao: data });
        }
      })
      .catch(error => {
        console.error('Erro na chamada da API Sienge:', error);
        exibirResultadoError();
      });
  }

  function exibirResultado(data) {
    var resultadoElemento = document.getElementById('resultado');
    resultadoElemento.innerHTML = "<pre>" + JSON.stringify(data, null, 2) + "</pre>";
  }

  function exibirResultadoError() {
    var resultadoElemento = document.getElementById('resultado');
    resultadoElemento.innerHTML = "<p>Ocorreu um erro ao chamar a API Sienge.</p>";
  }

  function enviarParaMilvus(data) {
    // Restante do código para enviar para a API Milvus
    // ...
  }
</script>
